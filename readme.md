# UniCalendar 跨端日历应用

- 项目名称：UniCalendar (智能日历)
- 开发日期：2025年11月30日

## 📟一.产品功能介绍

UniCalendar 是一款基于现代 Web 技术构建，并通过混合开发技术移植到 Android 平台的个人日程管理应用。它旨在以轻量、高效的方式，帮助用户管理日常安排，同时深度集成了中国传统农历功能。
## 1.1核心功能模块
### 多维度日历视图
- 月视图 (Month View)：提供宏观视角，展示整月的日期分布。并在单元格内通过颜色标记日程，直观显示忙碌程度。
- 周视图 (Week View)：侧重于周内的时间分配，方便用户规划一周的工作与生活平衡。
- 日视图 (Day View)：聚焦当天的详细时间线，展示日程的具体时间点和详细描述。

### 全功能的日程管理 (CRUD)
- 新建：支持点击任意日期快速创建日程，可设置标题、起止时间、详情描述及颜色分类（如工作、生活、重要事项）。
- 编辑与删除：用户可随时修改已有日程的信息，或删除取消的行程。

### 本地化农历支持
- 针对中国用户习惯，日历集成了精准的农历算法。
- 在公历日期旁显示农历日期（初一、十五等）。
- 节气与节日：优先展示二十四节气（如清明、冬至）和传统节日（春节、中秋），弘扬传统文化。

### 跨平台数据交互 (Import/Export)
- 导出 (.ics)：支持将本地数据导出为国际标准的 iCalendar 格式文件，可轻松迁移至 Outlook、Google Calendar 或系统原生日历。
- 导入：支持解析外部 .ics 文件，一键导入课程表或会议安排。

### 智能消息提醒
 - 应用后台内置轮询机制，当到达设定的日程时间时，会自动触发系统通知，防止用户遗漏重要事项。

## 🕵️‍♂️二. 程序概要设计

本章节介绍应用的开发环境、技术选型及数据结构设计，展示了如何从零构建一个跨端应用。

### 2.1 技术选型与开发环境
本项目采用了 **“Vue 3 前端 + Capacitor 跨端容器”** 的技术架构，既保证了开发效率，又满足了 Android 原生运行的要求。

| **分层**      | **技术名称**                |  **选择理由**                                                      |
| ----------- | ----------------------- | -------------------------------------------------------------- |
| 视图层 (View)  | Vue 3 (Composition API) | 当前最主流的前端框架，组件化思想清晰，易于上手和维护。                                    |
| UI 框架       | Tailwind CSS            | 原子化 CSS 库，无需手写大量样式文件，快速实现响应式布局。                                |
| 逻辑层 (Logic) | JavaScript (ES6+)       | 标准脚本语言，配合 Vue 处理业务逻辑。                                          |
| 跨端桥接        | Capacitor               | **核心技术** 它将 Web 页面包裹在 Android WebView 中，打包成 APK，实现“一套代码，多端运行”。 |
| 数据存储        | LocalStorage            | 浏览器自带的轻量级数据库，适合存储用户的 JSON 格式日程数据，无需配置复杂的服务器数据库。                |
| 工具库         | Lunar-javascript        | 专业的农历转换库，解决了复杂的干支纪年计算问题。                                       |

### 2.2 数据模型设计
应用的核心数据是“日程事件”，在代码中定义为 Event Object。数据以 JSON 数组的形式存储在本地。

- **日程对象结构示例：**
```
{
  "id": 1700982301234,        // 唯一ID (使用时间戳生成，防止重复)
  "title": "移动应用开发作业提交", // 标题
  "date": "2023-12-15",       // 日期 (YYYY-MM-DD 格式，方便排序)
  "time": "14:00",            // 时间 (HH:mm)
  "description": "需要包含PPT和源代码", // 详细描述
  "color": "bg-red-500"       // 颜色标签 (对应 UI 上的红色紧急标记)
}
```

### 2.3 目录结构规划

项目严格遵循组件化开发规范：
- ·src/components/：存放独立的 UI 模块（如 MonthView.vue 月视图组件、EventModal.vue 弹窗组件）。
-  src/composables/：存放核心逻辑 Hook（如 useCalendar.js 负责日历算法，useEventStore.js 负责数据读写）。
- ·src/utils/：存放工具类（如农历计算、ICS 文件解析）。

## 🎯三. 软件架构图

本应用采用经典的 **MVVM (Model-View-ViewModel)** 架构模式，实现了界面与数据的解耦。

### 3.1架构流程描述
1. **User (用户)** 点击或输入数据，触发 **View (视图层)** 的事件。
2.  **View (Vue 3)** 将事件传递给 **ViewModel (业务逻辑层)**。
	-  包含 useCalendar (日历算法) 和 useEventStore (数据管理)。
3.  **ViewModel** 处理完毕后，更新响应式数据，View 自动重新渲染。
4.  同时，ViewModel 通过 **Model (模型层)** 进行数据持久化。
	-  使用 LocalStorage 存储 JSON 数据。
	- 通过 Capacitor 桥接 Android 系统功能（如通知）。

### 3.2架构解析
1. **View (视图层)**：用户看到的界面，只负责显示。例如月视图网格的渲染。
2. **ViewModel (逻辑层)**：Vue 的核心。它负责计算“这个月有多少天”、“今天是初几”，并监听用户的添加/删除操作。
3. **Model (模型层)**：负责数据的存取。这里通过 LocalStorage 将数据保存在手机本地。

## 🚀四.运行项目

### 4.1环境搭建
安装前端vue3环境和android环境

### 4.2运行步骤
- 1.先从github上git clone，具体步骤见github官方教程
  
```
git clone https://github.com/ahia11/cool_calendar.git
```

- 2.安装依赖
```
npm install
```

- 3.运行项目
```
npm run dev
```

- 4.构建vue.js前端应用
```
npm run build
```

- 5.构建android项目
```
npx cap sync android
```

现在你可以看见你的文件夹生成了android项目，然后直接部署到android studio上运行就可以了

## 🪄五.技术亮点及其实现原理

### 4.1 动态日历网格算法 (42格计算法)
- **难点**：一个月的日历不仅仅是当月的 1-30 号，还必须包含上个月末尾的几天（补齐第一周）和下个月开头的几天（补齐最后一周），通常需要构建一个 6行 x 7列 = 42个格子的矩阵。
- **实现原理**：
1. 定锚点：找到当月 1 号是星期几（例如星期三）。
2. 向前回溯：如果 1 号是星期三，说明本周前面还有 3 天（周日、周一、周二），将日期指针向前拨 3 天，作为视图的起始日。
3. 循环生成：从起始日开始，连续循环 42 次，每次日期加 1 天。
4. 状态标记：在生成过程中，对比日期月份，标记哪些是“本月日期”（高亮显示），哪些是“非本月日期”（置灰显示）。

### 4.2 Web 到 Android 的跨端迁移 (Capacitor)
- **难点**：前端代码 (HTML/JS) 无法直接在安卓手机上作为 App 运行。
- **实现原理**：
1.使用 Vite 将 Vue 项目编译为静态资源（HTML/CSS/JS 文件），输出到 dist 目录。
2.使用 Capacitor 创建一个原生的 Android 项目壳子。
3.Capacitor 将 dist 目录的内容注入到 Android 的 WebView 组件中。WebView 就像一个内置的无边框浏览器。
4.最终生成的 APK 安装包，实际上是在运行一个全屏的网页，但用户体验接近原生应用。
  
### 4.3 纯前端实现的 .ics 文件解析
- **难点**：需要与 Outlook 或 Google 日历进行数据交换，通过 RFC 5545 标准协议。
- **实现原理**：
	- 导出：利用 JavaScript 的字符串拼接，按照 BEGIN:VEVENT ... END:VEVENT 的格式组装文本，并转化为 Blob 对象触发浏览器下载。
	- 导入：使用 FileReader 读取文件文本，编写了一个状态机解析器。按行读取，当遇到 BEGIN:VEVENT 时开始记录，遇到 SUMMARY 提取标题，直到 END:VEVENT 完成一个日程的转换。
## 🤓六.总结
- 本项目成功实现了一个功能完备的日历应用。通过 Vue 3 实现了复杂的交互逻辑，利用 Tailwind CSS 保证了界面的美观与响应式，最后通过 Capacitor 完成了 Android 端的打包。这不仅锻炼了前端组件化开发能力，也实践了移动端混合开发的完整流程。
